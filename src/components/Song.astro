---
import type { listeningHistory } from "../lib/db";

type Props = {
  song: typeof listeningHistory.$inferInsert;
  idx: number;
};

const { song, idx } = Astro.props;

function formatTime(time_ms: number) {
  const minutes = Math.floor(time_ms / 60000);
  const seconds = ((time_ms % 60000) / 1000).toFixed(0);
  return `${minutes}:${parseInt(seconds) < 10 ? "0" : ""}${seconds}`;
}
---

<div
  class="grid grid-cols-8 gap-4 items-center p-2 hover:bg-gray-800 transition-colors duration-250 ease-in-out rounded-lg"
>
  <span class="text-gray-400 text-center">{idx}</span>
  <div class="flex col-span-4 space-x-4 items-center">
    <img
      class="rounded-md w-12 h-12 md:w-16 md:h-16 shadow-sm"
      src={song.art}
      alt={song.song}
    />
    <div class="flex flex-col">
      <h3 class="text-base md:text-lg font-medium text-white truncate">
        {song.song}
      </h3>
      <p class="text-sm text-gray-400 truncate">{song.artist}</p>
    </div>
  </div>
  <div class="hidden md:block col-span-2 text-gray-400 truncate">
    {song.album}
  </div>
  <div class="text-right text-gray-400">
    {formatTime(song.length)}
  </div>
</div>
